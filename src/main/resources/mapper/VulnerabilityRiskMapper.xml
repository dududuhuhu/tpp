<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tpp.threat_perception_platform.dao.VulnerabilityRiskMapper">

    <resultMap id="BaseResultMap" type="com.tpp.threat_perception_platform.pojo.VulnerabilityRisk">
            <id property="id" column="id" />
            <result property="mac" column="mac" />
            <result property="ruleId" column="rule_id" />
            <result property="vulName" column="vul_name" />
            <result property="vulType" column="vul_type" />
            <result property="vulLevel" column="vul_level" />
            <result property="targetUrl" column="target_url" />
            <result property="payload" column="payload" />
            <result property="scanTime" column="scan_time" />
            <result property="responseTime" column="response_time" />
            <result property="isExit" column="is_exit" />
            <result property="errorMessage" column="error_message" />
    </resultMap>

    <sql id="Base_Column_List">
        id,mac,rule_id,vul_name,vul_type,vul_level,
        target_url,payload,scan_time,response_time,is_exit,
        error_message
    </sql>

    <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List" />
        from vulnerability_risk
        where  id = #{id} 
    </select>
    <select id="selectByMacAndRuleId" resultType="com.tpp.threat_perception_platform.pojo.VulnerabilityRisk">
        select
        <include refid="Base_Column_List" />
        from vulnerability_risk
        where mac = #{mac} and rule_id = #{ruleId}
    </select>
    <select id="findAll" resultType="com.tpp.threat_perception_platform.pojo.VulnerabilityRisk">
        select
        <include refid="Base_Column_List" />
        from vulnerability_risk
        where  mac = #{mac}
    </select>

    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        delete from vulnerability_risk
        where  id = #{id} 
    </delete>
    <insert id="insert" keyColumn="id" keyProperty="id" parameterType="com.tpp.threat_perception_platform.pojo.VulnerabilityRisk" useGeneratedKeys="true">
        insert into vulnerability_risk
        ( id,mac,rule_id,vul_name,vul_type,vul_level,
        target_url,payload,scan_time,response_time,is_exit,
        error_message)
        values (#{id},#{mac},#{ruleId},#{vulName},#{vulType},#{vulLevel},
        #{targetUrl},#{payload},#{scanTime},#{responseTime},#{isExit},
        #{errorMessage})
    </insert>
    <insert id="insertSelective" keyColumn="id" keyProperty="id" parameterType="com.tpp.threat_perception_platform.pojo.VulnerabilityRisk" useGeneratedKeys="true">
        insert into vulnerability_risk
        <trim prefix="(" suffix=")" suffixOverrides=",">
                <if test="id != null">id,</if>
                <if test="mac != null">mac,</if>
                <if test="ruleId != null">rule_id,</if>
                <if test="vulName != null">vul_name,</if>
                <if test="vulType != null">vul_type,</if>
                <if test="vulLevel != null">vul_level,</if>
                <if test="targetUrl != null">target_url,</if>
                <if test="payload != null">payload,</if>
                <if test="scanTime != null">scan_time,</if>
                <if test="responseTime != null">response_time,</if>
                <if test="isExit != null">is_exit,</if>
                <if test="errorMessage != null">error_message,</if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
                <if test="id != null">#{id},</if>
                <if test="mac != null">#{mac},</if>
                <if test="ruleId != null">#{ruleId},</if>
                <if test="vulName != null">#{vulName},</if>
                <if test="vulType != null">#{vulType},</if>
                <if test="vulLevel != null">#{vulLevel},</if>
                <if test="targetUrl != null">#{targetUrl},</if>
                <if test="payload != null">#{payload},</if>
                <if test="scanTime != null">#{scanTime},</if>
                <if test="responseTime != null">#{responseTime},</if>
                <if test="isExit != null">#{isExit},</if>
                <if test="errorMessage != null">#{errorMessage},</if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.tpp.threat_perception_platform.pojo.VulnerabilityRisk">
        update vulnerability_risk
        <set>
                <if test="mac != null">
                    mac = #{mac},
                </if>
                <if test="ruleId != null">
                    rule_id = #{ruleId},
                </if>
                <if test="vulName != null">
                    vul_name = #{vulName},
                </if>
                <if test="vulType != null">
                    vul_type = #{vulType},
                </if>
                <if test="vulLevel != null">
                    vul_level = #{vulLevel},
                </if>
                <if test="targetUrl != null">
                    target_url = #{targetUrl},
                </if>
                <if test="payload != null">
                    payload = #{payload},
                </if>
                <if test="scanTime != null">
                    scan_time = #{scanTime},
                </if>
                <if test="responseTime != null">
                    response_time = #{responseTime},
                </if>
                <if test="isExit != null">
                    is_exit = #{isExit},
                </if>
                <if test="errorMessage != null">
                    error_message = #{errorMessage},
                </if>
        </set>
        where   id = #{id} 
    </update>
    <update id="updateByPrimaryKey" parameterType="com.tpp.threat_perception_platform.pojo.VulnerabilityRisk">
        update vulnerability_risk
        set 
            mac =  #{mac},
            rule_id =  #{ruleId},
            vul_name =  #{vulName},
            vul_type =  #{vulType},
            vul_level =  #{vulLevel},
            target_url =  #{targetUrl},
            payload =  #{payload},
            scan_time =  #{scanTime},
            response_time =  #{responseTime},
            is_exit =  #{isExit},
            error_message =  #{errorMessage}
        where   id = #{id} 
    </update>
</mapper>
