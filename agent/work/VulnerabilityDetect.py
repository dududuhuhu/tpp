# coding=utf-8
import json
from RiskDiscovery.vulnerability import VulnerabilityScanner

class VulnerabilityDetect:
    """
    漏洞探测类（非线程版本）
    """

    def __init__(self,data):
        # 可扩展初始化参数（如扫描目标等）
        self.results = []

    def detect(self) -> str:
        """
        外部调用接口：执行漏洞探测，返回 JSON 字符串
        """
        self.__vulnerability_detect()
        return json.dumps(self.results, ensure_ascii=False)

    def __vulnerability_detect(self):
        """
        内部实际探测逻辑
        """
        print("开始探测漏洞数据..............!")

        # 创建扫描器实例并执行
        scanner = VulnerabilityScanner()
        self.results = scanner.run_scan()

        print("探测漏洞数据结束！")
